<!DOCTYPE html><html lang="zh-cn"><head><title>JS Classic Code - One Piece Of Script</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link rel="stylesheet" href="/modest.css"><link rel="stylesheet" href="/style.css"></head><body><div class="container"><div class="side-col"><div class="AuthorInfo"><img class="Avatar" src="https://avatars0.githubusercontent.com/u/17768382?v=3&amp;s=460"><h3>One Piece Of Script</h3><p>Progressive Enhancement</p></div><ul class="linklist"><li><a href="/">home</a></li><li><a href="../">about</a></li></ul></div><div class="main-content page-content"><div class="page-header"><h1 class="title">JS Classic Code</h1><ul class="page-meta"><li class="author">Tony Wang</li><li class="date">星期二, 2017 8月 15日 , 晚上 10:08</li></ul></div><article class="markdown-body"><p>经典JS代码</p>
<a id="more"></a>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>当你创建一个新的对象时，你可以选择一个对象的原型，如下所示：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Object</span>.create !== <span class="string">'function'</span>) &#123;</div><div class="line">  <span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">    F.prototype = o;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">Object</span>.create 就是将对象作为原型生成一个新的对象。</div></pre></td></tr></table></figure></p>
<h2 id="For…In"><a href="#For…In" class="headerlink" title="For…In"></a>For…In</h2><p>for…in 循环会遍历对象中所有的包括原型链上的属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">a.prototype.b = <span class="number">1</span>;</div><div class="line">a.prototype.c = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> a();</div><div class="line">p.q = <span class="number">3</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> p)&#123;</div><div class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// q, b, c</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h2><p>delete只会删除当前对象中的属性，不会查找到prototype<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">a.prototype.b = <span class="number">1</span>;</div><div class="line">a.prototype.c = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> a();</div><div class="line">p.b =<span class="number">3</span>;</div><div class="line"><span class="built_in">console</span>.log(p.b); <span class="comment">// 3</span></div><div class="line"><span class="keyword">delete</span> p.b;</div><div class="line"><span class="built_in">console</span>.log(p.b); <span class="comment">// 1</span></div></pre></td></tr></table></figure></p>
<h2 id="Function-Objects"><a href="#Function-Objects" class="headerlink" title="Function Objects"></a>Function Objects</h2><p>函数<em>创建时</em>，函数自身作为一个对象，<strong>proto</strong>关联到Function的prototype，同时创建自身的prototype，其中包括constructor，指向自身(可以看到其<strong>proto</strong>是个Function的prototype)</p>
<blockquote>
<p>When a function object is created, the Function constructor that produces the func- tion object runs some code like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.prototype = &#123;<span class="attr">constructor</span>: <span class="keyword">this</span>&#125;;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>，另外同时创建两个隐藏属性：函数的运行环境Scope，以及函数体里的代码。</p>
<blockquote>
<p>The function object created by a function literal contains a link to that outer context. This is called closure. </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(b); <span class="comment">// 创建时b就关联到了外层上下文的b</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> b = <span class="number">3</span>;</div><div class="line">  a();</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> b = <span class="number">1</span>;</div><div class="line">c();</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( a.prototype.constructor === a) <span class="comment">//true</span></div></pre></td></tr></table></figure>
<h2 id="Function-Invocation"><a href="#Function-Invocation" class="headerlink" title="Function Invocation"></a>Function Invocation</h2><p>函数在<em>调用时</em>，函数会动态的收到两个额外的参数，this和arguments。在不同的调用场景下，this的赋值是不同的！</p>
<h3 id="作为对象方法调用-Method"><a href="#作为对象方法调用-Method" class="headerlink" title="作为对象方法调用(Method)"></a>作为对象方法调用(Method)</h3><p>method使用this来访问对象中的属性，this在调用时绑定。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">value</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">increment</span>: <span class="function"><span class="keyword">function</span>(<span class="params">inc</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.value += <span class="keyword">typeof</span> inc === <span class="string">'number'</span> ? inc : <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">myObject.increment(); </div><div class="line"><span class="built_in">console</span>.log(myObject.value);</div></pre></td></tr></table></figure></p>
<h3 id="作为函数调用-Function"><a href="#作为函数调用-Function" class="headerlink" title="作为函数调用(Function)"></a>作为函数调用(Function)</h3><p>当函数这样调用时，this绑定在全局对象上。</p>
<blockquote>
<p>inner function does not share the method’s access to the object as its this is bound to the wrong value</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">    b();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.a(); <span class="comment">// 还是会输出window对象</span></div><div class="line"></div><div class="line"><span class="comment">// 解决方案</span></div><div class="line">obj.a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(that);</div><div class="line">  &#125;</div><div class="line">  b(); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="作为Constructor调用"><a href="#作为Constructor调用" class="headerlink" title="作为Constructor调用"></a>作为Constructor调用</h3><p>作为构造器调用时，this在运行时赋值为新建的对象，该对象的原型<strong>proto</strong>是由原构造器的prototype中的方法与属性，加上一个额外constructor属性指向构造器本身<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.str = str;</div><div class="line">&#125;</div><div class="line">a.prototype.read = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.str);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> a();</div><div class="line"></div><div class="line"><span class="comment">// 如果构造器原型中有constructor，这个属性是可以被替代的！！！</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.str = str;</div><div class="line">&#125;</div><div class="line">a.prototype.constructor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.str);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> a(); </div><div class="line">b.__proto__.constructor === a <span class="comment">// false</span></div><div class="line">b.__proto__.constructor === a.prototype.constructor <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// 如果构造器返回一个对象，那么就只有这个对象，没有prototype</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">str</span>: str,</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">a.prototype.read = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.str);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> a();</div><div class="line">b.read() <span class="comment">//  b.read is not a function</span></div></pre></td></tr></table></figure></p>
<p>函数作为构造器调用的缺点在于如果你忘了加new关键字，那么，this将指向global，但是这并不会报错，这是语言设计中的缺陷。那么解决方法一个就是构造器函数的名字必须大写开头，另一个就是完全不用new。</p>
<h3 id="使用Function原型中的方法来调用"><a href="#使用Function原型中的方法来调用" class="headerlink" title="使用Function原型中的方法来调用"></a>使用Function原型中的方法来调用</h3><p>在调用时主动声明this与parameter被赋予的值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.a + <span class="keyword">this</span>.b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">3</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> c = add.apply(obj)</div><div class="line"><span class="built_in">console</span>.log(c);</div></pre></td></tr></table></figure></p>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>函数中声明了一个函数，那这个函数通过scope chain就可以访问到外层函数的变量，叫做闭包。</p>
<blockquote>
<p>A more interesting case is when the inner function has a longer lifetime than its outer function.<br>当内部的函数比外部函数的生命周期更长时，闭包就变得有趣了。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fade = <span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> level = <span class="number">1</span>;</div><div class="line">  <span class="keyword">var</span> step = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> hex = level.toString(<span class="number">16</span>); </div><div class="line">    node.style.backgroundColor = <span class="string">'#FFFF'</span> + hex + hex; </div><div class="line">    <span class="keyword">if</span> (level &lt; <span class="number">15</span>) &#123;</div><div class="line">      level += <span class="number">1</span>;</div><div class="line">        setTimeout(step, <span class="number">100</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">  setTimeout(step, <span class="number">100</span>);</div><div class="line">&#125;;</div><div class="line">fade(<span class="built_in">document</span>.body);</div></pre></td></tr></table></figure></p>
<p>Inner function has access to the actual variables of the outer functions and not copies。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> add_the_handlers = <span class="function"><span class="keyword">function</span> (<span class="params">nodes</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i;</div><div class="line"> <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nodes.length; i += <span class="number">1</span>) &#123;</div><div class="line">    nodes[i].onclick = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        alert(i); </div><div class="line">    &#125;;</div><div class="line">  &#125; </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>但是作为参数传入的<em>基本类型变量</em>就是一个copy了，<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> add_the_handlers = <span class="function"><span class="keyword">function</span> (<span class="params">nodes</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i;</div><div class="line"> <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nodes.length; i += <span class="number">1</span>) &#123;</div><div class="line">    nodes[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        alert(i); </div><div class="line">      &#125;</div><div class="line">    &#125;(i);</div><div class="line">  &#125; </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>那如果是引用类型呢？那当然就没用啦，参数传导引用类型也是作为一个引用来传递。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> add_the_handlers = <span class="function"><span class="keyword">function</span> (<span class="params">nodes</span>) </span>&#123;</div><div class="line"> <span class="keyword">var</span> i;</div><div class="line"> <span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>:<span class="number">2</span>,</div><div class="line">  <span class="attr">b</span>:<span class="number">3</span>,</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nodes.length; i += <span class="number">1</span>) &#123;</div><div class="line">    nodes[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">        alert(obj.a); </div><div class="line">      &#125;</div><div class="line">    &#125;(obj);</div><div class="line">    obj.a += <span class="number">1</span>;</div><div class="line">  &#125; </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h2 id="Cascade"><a href="#Cascade" class="headerlink" title="Cascade"></a>Cascade</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">getElement(<span class="string">'myBoxDiv'</span>).</div><div class="line">  move(<span class="number">350</span>, <span class="number">150</span>).</div><div class="line">  width(<span class="number">100</span>).</div><div class="line">  height(<span class="number">100</span>).</div><div class="line">  color(<span class="string">'red'</span>).</div><div class="line">  border(<span class="string">'10px outset'</span>).</div><div class="line">  padding(<span class="string">'4px'</span>).</div><div class="line">  appendText(<span class="string">"Please stand by"</span>).</div><div class="line">  on(<span class="string">'mousedown'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.startDrag(m, <span class="keyword">this</span>.getNinth(m));</div><div class="line">  &#125;).</div><div class="line">  on(<span class="string">'mousemove'</span>, <span class="string">'drag'</span>). </div><div class="line">  on(<span class="string">'mouseup'</span>, <span class="string">'stopDrag'</span>). </div><div class="line">  later(<span class="number">2000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.</div><div class="line">      color(<span class="string">'yellow'</span>).</div><div class="line">      setHTML(<span class="string">"What hath God wraught?"</span>).</div><div class="line">      slide(<span class="number">400</span>, <span class="number">40</span>, <span class="number">200</span>, <span class="number">200</span>);</div><div class="line">  &#125;).</div><div class="line">  tip(<span class="string">'This box is resizeable'</span>);</div></pre></td></tr></table></figure>
<h2 id="Curry"><a href="#Curry" class="headerlink" title="Curry"></a>Curry</h2><p>就是为了分次定义参数，返回最终的函数调用入口<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.method(<span class="string">'curry'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> slice = <span class="built_in">Array</span>.prototype.slice,</div><div class="line">      args = <span class="built_in">arguments</span>,</div><div class="line">      that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> that.apply(<span class="literal">null</span>, args.concat(slice.apply(<span class="built_in">arguments</span>)));</div><div class="line">  &#125;;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="Memoization"><a href="#Memoization" class="headerlink" title="Memoization"></a>Memoization</h2><blockquote>
<p>Functions can use objects to remember the results of previous operations, making it possible to avoid unnecessary work. This optimization is called memoization.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fibonacci = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> n &lt; <span class="number">2</span> ? n : fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> fibonacci = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> memo = [<span class="number">0</span>, <span class="number">1</span>];</div><div class="line">  <span class="keyword">var</span> fib = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result = memo[n];</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> result !== <span class="string">'number'</span>) &#123;</div><div class="line">      result = fib(n<span class="number">-1</span>) + fib(n<span class="number">-2</span>);</div><div class="line">      memo[n] = result;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> fib;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="继承三种方式"><a href="#继承三种方式" class="headerlink" title="继承三种方式"></a>继承三种方式</h2><blockquote>
<p>The instanceof operator tests presence of constructor.prototype in object’s prototype chain.</p>
</blockquote>
<p>[Object] instanceof [Function]</p>
<h3 id="伪类继承（Pseudoclassical）"><a href="#伪类继承（Pseudoclassical）" class="headerlink" title="伪类继承（Pseudoclassical）"></a>伪类继承（Pseudoclassical）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">b.prototype = <span class="built_in">Object</span>.create(a.prototype);</div><div class="line">b.prototype = <span class="keyword">new</span> a();</div><div class="line">b <span class="keyword">instanceof</span> a; <span class="comment">//true</span></div></pre></td></tr></table></figure>
<h3 id="原型继承（Prototypal）"><a href="#原型继承（Prototypal）" class="headerlink" title="原型继承（Prototypal）"></a>原型继承（Prototypal）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;</div><div class="line">  <span class="attr">a1</span>:<span class="number">2</span>,</div><div class="line">  <span class="attr">a2</span>:<span class="number">3</span>,</div><div class="line">  getA1() &#123;<span class="keyword">return</span> <span class="keyword">this</span>.a1;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = <span class="built_in">Object</span>.create(a);</div><div class="line">b.a1 = <span class="number">4</span>;</div><div class="line">b.getA1();</div></pre></td></tr></table></figure>
<h3 id="函数继承（Functional）"><a href="#函数继承（Functional）" class="headerlink" title="函数继承（Functional）"></a>函数继承（Functional）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">superior</span>(<span class="params">obj, name</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> superfunc = obj[name];</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> superfunc.apply(obj, <span class="built_in">arguments</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> private_a = <span class="number">1</span>;</div><div class="line">  <span class="keyword">var</span> that = &#123;&#125;;</div><div class="line">  <span class="keyword">var</span> getPrivateA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> private_a;&#125;</div><div class="line"></div><div class="line">  that.getPrivateA = getPrivateA;</div><div class="line">  <span class="keyword">return</span> that;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> that = a();</div><div class="line">  <span class="keyword">var</span> private_b = <span class="number">4</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> getSuperiorA = superior(that, getPrivateA);</div><div class="line"></div><div class="line">  <span class="keyword">var</span> getPrivateC = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> that.getPrivateA() + private_b;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> getPrivateA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> that.getSuperiorA() + <span class="string">'from parent'</span>;</div><div class="line">  &#125;</div><div class="line">  that.getPrivateC = getPrivateC;</div><div class="line">  that.getPrivateA = getPrivateA;</div><div class="line">  <span class="keyword">return</span> that;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Make-Any-Object-reactable"><a href="#Make-Any-Object-reactable" class="headerlink" title="Make Any Object reactable"></a>Make Any Object reactable</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> makeReactable = <span class="function"><span class="keyword">function</span>(<span class="params">that</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> registry = &#123;&#125;</div><div class="line">  that.fire = <span class="function"><span class="keyword">function</span>(<span class="params">event, parameters</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> handlers,</div><div class="line">        params,</div><div class="line">        func, </div><div class="line">        type = <span class="keyword">typeof</span> event === <span class="string">'string'</span> ? </div><div class="line">              event: event.type</div><div class="line">    <span class="keyword">if</span>(registry.hasOwnProperty(type))&#123;</div><div class="line">      handlers = registry[type];</div><div class="line">      handlers.forEach(<span class="function">(<span class="params">handler</span>) =&gt;</span> &#123;</div><div class="line">        params = handler.parameters;</div><div class="line">        func = handler.method;</div><div class="line">        <span class="keyword">if</span>(parameters) &#123;</div><div class="line">          params = params.concat(parameters);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> func === <span class="string">'string'</span>)&#123;</div><div class="line">          func = that[func];</div><div class="line">        &#125;</div><div class="line">        func.apply(that, params)</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  that.on = <span class="function"><span class="keyword">function</span>(<span class="params">type, method, parameters</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> handler = &#123;</div><div class="line">      <span class="attr">method</span>: method,</div><div class="line">      <span class="attr">parameters</span>: parameters || [],</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(registry.hasOwnProperty(type))&#123;</div><div class="line">      registry[type].push(handler) </div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      registry[type] = [handler];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line">makeReactable(obj);</div><div class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'a'</span>, &#123;</div><div class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">val</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(val !== <span class="keyword">this</span>.value)&#123;</div><div class="line">      <span class="keyword">this</span>.fire(<span class="string">'changed'</span>, [&#123;<span class="attr">param</span>:<span class="string">'a'</span>, <span class="attr">from</span>: <span class="keyword">this</span>.value, <span class="attr">to</span>: val&#125;]);</div><div class="line">      <span class="keyword">this</span>.value = val;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.value</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">obj.on(<span class="string">'changed'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(msg);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">obj.a = <span class="number">4</span>;</div></pre></td></tr></table></figure>
<h2 id="判断是否为一个数组"><a href="#判断是否为一个数组" class="headerlink" title="判断是否为一个数组"></a>判断是否为一个数组</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> is_array = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> value &amp;&amp;</div><div class="line">      <span class="keyword">typeof</span> value === <span class="string">'object'</span> &amp;&amp; </div><div class="line">      <span class="comment">// value.constructor === Array 如果数组是在另一个window对象下面的Array创建的就会失效</span></div><div class="line">      <span class="keyword">typeof</span> value.length === <span class="string">'number'</span> &amp;&amp; </div><div class="line">      <span class="keyword">typeof</span> value.splice === <span class="string">'function'</span> &amp;&amp; </div><div class="line">      !(value.propertyIsEnumerable(<span class="string">'length'</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="深克隆"><a href="#深克隆" class="headerlink" title="深克隆"></a>深克隆</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.prototype.clone = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params">prop</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> prop === <span class="string">'object'</span> &amp;&amp; prop !== <span class="literal">null</span>)&#123;</div><div class="line">      <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(prop))&#123;</div><div class="line">        <span class="keyword">return</span> prop.map(<span class="function"><span class="params">item</span> =&gt;</span> (walk(item)));</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">const</span> obj = &#123;&#125;;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.keys(prop).reduce(<span class="function">(<span class="params">accu, key</span>) =&gt;</span> &#123;</div><div class="line">          accu[key] = walk(prop[key]);</div><div class="line">          <span class="keyword">return</span> accu;</div><div class="line">        &#125;, obj);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">return</span> prop;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> walk(<span class="keyword">this</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</article></div></div></body></html>