<!DOCTYPE html><html lang="zh-cn"><head><title>es6 Cheat Sheet - One Piece Of Script</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link rel="stylesheet" href="/modest.css"><link rel="stylesheet" href="/style.css"></head><body><div class="container"><div class="side-col"><div class="AuthorInfo"><img class="Avatar" src="https://avatars0.githubusercontent.com/u/17768382?v=3&amp;s=460"><h3>One Piece Of Script</h3><p>Progressive Enhancement</p></div><ul class="linklist"><li><a href="/">home</a></li><li><a href="../">about</a></li></ul></div><div class="main-content page-content"><div class="page-header"><h1 class="title">es6 Cheat Sheet</h1><ul class="page-meta"><li class="author">Tony Wang</li><li class="date">星期六, 2017 5月 13日 , 下午 3:20</li></ul></div><article class="markdown-body"><p>es6 标准速查</p>
<a id="more"></a>
<h2 id="getter-setter方法"><a href="#getter-setter方法" class="headerlink" title="getter setter方法"></a>getter setter方法</h2><p>getter setter在js中有两种定义方式：</p>
<ul>
<li>在Object中或者Class中直接用’get 变量名()’, ‘set 变量名(value)’方式定义</li>
<li>使用Object.defineProperty(对象, 变量名，{get set})<br>第一种方式的缺点在于，不能定义’private’的变量，就算有get set方法，还是能够通过obj.变量名的方式访问到。<br>第二种方式就可以用于闭包中：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">whateverClass</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">let</span> local_variable = <span class="string">"xxx"</span>;</div><div class="line">	<span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>, <span class="string">'somevar'</span>, &#123;</div><div class="line">		<span class="attr">get</span>: <span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">			<span class="comment">// ...</span></div><div class="line">			<span class="keyword">return</span> local_variable;</div><div class="line">		&#125;,</div><div class="line">		<span class="attr">set</span>: <span class="function">(<span class="params">value</span>) =&gt;</span>&#123;</div><div class="line">			<span class="comment">// ...</span></div><div class="line">			local_variable = value</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> whatever = <span class="keyword">new</span> whateverClass();</div><div class="line">whatever.somevar === <span class="string">"xxx"</span> <span class="comment">//getter</span></div><div class="line">whatever.somevar = <span class="string">"aaa"</span> <span class="comment">//setter</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>使用该方法的场景包括：数据验证，一个数据由对象内部属性计算得到。</p>
<h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h2><p>就像一个陷阱，你要去访问proxy后的对象，你必须穿过这些陷阱。其中的陷阱包括：</p>
<ul>
<li>apply 函数调用时触发</li>
<li>constructor 对象创建时</li>
<li>get/set 属性访问/更改时</li>
<li>enumerate for-in时</li>
<li>getPrototypeOf/setPrototypeOf 原型访问/修改时<br>无法被Proxy代理的方法包括 ===、==、instanceOf、typeOf<br>应用场景：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeLoggable</span>(<span class="params">target</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</div><div class="line">		<span class="attr">get</span>: <span class="function">(<span class="params">target, property</span>) =&gt;</span> &#123;</div><div class="line">			report(<span class="string">"Reading "</span> + property);</div><div class="line">      		<span class="keyword">return</span> target[property];</div><div class="line">		&#125;,</div><div class="line">		<span class="attr">set</span>: <span class="function">(<span class="params">target, property, value</span>) =&gt;</span> &#123;</div><div class="line">			report(<span class="string">"Writing value "</span> + value + <span class="string">" to "</span> + property);</div><div class="line">      		target[property] = value;</div><div class="line">		&#125;</div><div class="line">	&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> client = &#123;<span class="attr">name</span>: <span class="string">"neanderthals"</span>&#125; </div><div class="line">client = makeLoggable(client); <span class="comment">// client所指向的对象依然在内存中</span></div><div class="line">client.liveIn = <span class="string">"cave"</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>相比于直接使用Object.defineProperty，Proxy在保证了对象属性私有化的同时，简化了对象属性getter,setter的设置，适用于可变的场景之下。</p>
<p>代理函数apply, 每当调用函数时，其实是调用proxy下的apply方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPrime</span>(<span class="params">number</span>)</span>&#123;</div><div class="line">	<span class="keyword">if</span>(number&lt;<span class="number">2</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;number; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(number%i === <span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">return</span> <span class="literal">false</span>; </div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line">isPrime = <span class="keyword">new</span> <span class="built_in">Proxy</span>(isPrime, &#123;</div><div class="line">	<span class="attr">apply</span>: <span class="function">(<span class="params">target, thisArg, args</span>) =&gt;</span> &#123;</div><div class="line">		<span class="comment">// before apply</span></div><div class="line">		<span class="keyword">const</span> result = target.apply(thisArg, args);</div><div class="line">		<span class="comment">// after apply</span></div><div class="line">		<span class="keyword">return</span> result;</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">isPrime(<span class="number">12356</span>);</div></pre></td></tr></table></figure></p>
<h3 id="看看Proxy都能做些什么"><a href="#看看Proxy都能做些什么" class="headerlink" title="看看Proxy都能做些什么"></a>看看Proxy都能做些什么</h3><p>自动为变量赋值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Folder</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">		<span class="attr">get</span>: <span class="function">(<span class="params">target, property</span>) =&gt;</span> &#123;</div><div class="line">			<span class="keyword">if</span>(property <span class="keyword">in</span> target)&#123;</div><div class="line">				target[property] = <span class="keyword">new</span> Folder();</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> target[property];</div><div class="line">		&#125;</div><div class="line">	&#125;);	</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> root = <span class="keyword">new</span> Folder();</div><div class="line"></div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">	root.dir1.dir2.dir3.file = <span class="string">"hardtofind.txt"</span>;</div><div class="line">&#125;<span class="keyword">catch</span>(e)&#123;	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>使用负数倒序访问数组<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createNegativeIndex</span>(<span class="params">arr</span>)</span>&#123;</div><div class="line">	<span class="keyword">if</span>(!<span class="built_in">Array</span>.isArray(arr))&#123;</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Expect an Array!"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(arr, &#123;</div><div class="line">		<span class="attr">get</span>: <span class="function">(<span class="params">target, index</span>) =&gt;</span> &#123;</div><div class="line">			index = +index;</div><div class="line">			<span class="keyword">return</span> target[index&lt;<span class="number">0</span>?:target.length+index:index];</div><div class="line">		&#125;,</div><div class="line">		<span class="attr">set</span>: <span class="function">(<span class="params">target, index, val</span>) =&gt;</span> &#123;</div><div class="line">			index = +index;</div><div class="line">			<span class="keyword">return</span> target[index &lt; <span class="number">0</span> ? target.length + index : index] = val;</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> heros = [<span class="string">"kukka"</span>, <span class="string">"lion"</span>, <span class="string">"warlock"</span>]; </div><div class="line"><span class="keyword">const</span> proxiedHeros = createNegativeIndex(heros);</div><div class="line">assert(proxiedHeros[<span class="number">-1</span>]===<span class="string">"warlock"</span>, <span class="string">"negative index works!"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 效率测试！</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">measure</span>(<span class="params">items</span>)</span>&#123;</div><div class="line">  <span class="keyword">const</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">50000000</span>; i++)&#123;</div><div class="line">    items[<span class="number">0</span>] === <span class="string">"kukka"</span>;</div><div class="line">    items[<span class="number">1</span>] === <span class="string">"lion"</span>;</div><div class="line">    items[<span class="number">2</span>] === <span class="string">"warlock"</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() - startTime;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> timeProxy = <span class="built_in">Math</span>.round(measure(proxiedHeros));</div><div class="line"><span class="keyword">const</span> timeNormal = <span class="built_in">Math</span>.round(measure(heros));</div><div class="line"></div><div class="line"><span class="comment">// 运行在chrome上的效率为 32885 1423 23.109627547434997，之间差了23倍。避免使用在频繁读写的对象上</span></div><div class="line"><span class="built_in">console</span>.log(timeProxy, timeNormal, timeProxy/timeNormal);</div></pre></td></tr></table></figure></p>
<h2 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">`a missing word <span class="subst">$&#123;word&#125;</span>`</span></div></pre></td></tr></table></figure>
<h2 id="函数参数列表"><a href="#函数参数列表" class="headerlink" title="函数参数列表"></a>函数参数列表</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">	somefunc(1,2,3,4,5);</div><div class="line">	a = 1;</div><div class="line">	b=[2,3,4,5]</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">somefunc</span>(<span class="params">a, ...b</span>)</span>&#123; <span class="comment">/* ... */</span>&#125; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">default</span>(<span class="params">a, b=<span class="string">'somedefaultparam'</span></span>)</span>&#123;<span class="keyword">return</span> a + b;&#125;</div></pre></td></tr></table></figure>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> value = [<span class="number">332</span>,<span class="number">212</span>,<span class="number">32</span>,<span class="number">43</span>,<span class="number">5</span>];</div><div class="line">value.sort(<span class="function">(<span class="params">a, b</span>)=&gt;</span> a-b);</div><div class="line"><span class="comment">/* or */</span></div><div class="line">value.sort(<span class="function">(<span class="params">a, b</span>)=&gt;</span> &#123;<span class="keyword">return</span> a-b;&#125;);</div><div class="line"></div><div class="line">value.forEach(<span class="function">(<span class="params">val</span>)=&gt;</span>&#123;<span class="built_in">console</span>.log(val)&#125;)</div></pre></td></tr></table></figure>
<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">IdGenerator</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">let</span> id = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(<span class="literal">true</span>)&#123;</div><div class="line">		<span class="keyword">yield</span> ++id;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> IdGen = IdGenerator();</div><div class="line"><span class="built_in">console</span>.log(IdGen.next().value); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(IdGen.next().value); <span class="comment">// 2</span></div><div class="line"><span class="built_in">console</span>.log(IdGen.next().value); <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;<span class="comment">/* ... */</span>&#125;)</div><div class="line">promise.then(<span class="function"><span class="params">val</span> =&gt;</span> &#123;<span class="built_in">console</span>.log(<span class="string">"success!"</span>);&#125;, err =&gt; &#123;<span class="built_in">console</span>.log(<span class="string">"Error!"</span>);&#125;)<span class="comment">//success or failure calback</span></div><div class="line">	.catch(<span class="function"><span class="params">e</span> =&gt;</span> alert(e))<span class="comment">//promise failure</span></div></pre></td></tr></table></figure>
</article></div></div></body></html>