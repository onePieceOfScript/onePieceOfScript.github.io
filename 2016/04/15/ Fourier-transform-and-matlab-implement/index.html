<!DOCTYPE html><html lang="zh-cn"><head><title>二维图像傅里叶变换及相关的滤波技术，附MATLAB实现 - One Piece Of Script</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link rel="stylesheet" href="/modest.css"><link rel="stylesheet" href="/style.css"><link rel="icon" href="https://avatars0.githubusercontent.com/u/17768382?v=3&amp;s=32" type="image/x-icon"></head><body><div class="container"><div class="side-col"><div class="AuthorInfo"><img class="Avatar" src="https://avatars0.githubusercontent.com/u/17768382?v=3&amp;s=460"><h3>One Piece Of Script</h3><p>Progressive Enhancement</p></div><ul class="linklist"><li><a href="/">home</a></li><li><a href="../">about</a></li></ul></div><div class="main-content page-content"><div class="page-header"><h1 class="title">二维图像傅里叶变换及相关的滤波技术，附MATLAB实现</h1><ul class="page-meta"><li class="author">Tony Wang</li><li class="date">星期五, 2016 4月 15日 , 下午 4:47</li></ul></div><article class="markdown-body"><p>很多人在学习图像处理的时候都会碰到傅里叶变换，这是频域图像处理的基础，但由于各种资料及论文介绍的太过学术，公式完全就不想让人看懂的样子，复杂到让人望而生畏。但其实这玩意就是个程序化的东西，在数字图像处理中，并不需要非常清楚具体傅里叶变换是怎么变得，我们只需要知道这是个黑盒，输入图像，然后变换到频域，展现频谱，对频谱分析处理，用所谓的滤波器去掉我们不需要的部分，然后再通过这个黑盒变回来就结束了。</p>
<a id="more"></a>
<hr>
<h2 id="下面来具体介绍这是个啥玩意："><a href="#下面来具体介绍这是个啥玩意：" class="headerlink" title="下面来具体介绍这是个啥玩意："></a>下面来具体介绍这是个啥玩意：</h2><p>先上公式：<br><img src="http://latex.codecogs.com/gif.latex?F%28u%2Cv%29%3D%5Csum_%7Bx%3D0%7D%5E%7BM-1%7D%5Csum_%7By%3D0%7D%5E%7BN-1%7Df%28x%2Cy%29e%5E%7B-j2%5Cpi%20%28ux/M&plus;vy/N%29%7D" alt="傅里叶公式"></p>
<p>这两个公式正是正变换和逆变换的公式，单从公式上来看，就是把图像f上对应的每个像素f(x,y)与后面那一串expXXX的做了一个卷积，但这玩意计算复杂度太大了，大概是O(n^4)，如果大一点的图片比如1000*800，那可以算好几天。。。<br>所以后来有人发明了快速傅里叶变换(FFT)，不用管这玩意是怎么实现，我们只要在心里佩服下这位仁兄，然后直接拿来用就可以了，和这两个公式做到的事情是一样的。<br>另外还有一组对应关系很重要：</p>
<p>这组关系说的就是空域的卷积相当于频域的乘积，反过来也成立，这个不得了了~我们可以用这个干很多事情，比如在频域对变换过的图像做一些操作，再返回空域，就会产生不同的效果。暂且不管什么操作对应什么效果，我们先可以玩起来。</p>
<h2 id="显示频谱"><a href="#显示频谱" class="headerlink" title="显示频谱"></a>显示频谱</h2><p>因为MATLAB中的fft变换默认把频域结果设置在[0,pi]，所以我们需要调用fftshift()把中心移动到频谱图像中心，这样显示起来比较直观，<br>所以后面所提到的滤波器里面的距离都是距离图像中心的距离（很关键！）。要在图像上显示频谱，需要获取傅里叶变换后单点的幅度，就用read与imag函数提取变换后的实部和虚部（感谢欧拉），然后取模，就是频谱，当然频谱不会在[0，255]，所以需要做归一化到[0，255]，然后就能以图像来显示了。通过观察频谱，中间的部分表示低频区域，越向外围越是高频区域。先不管低频和高频到底是个什么玩意，我们先可以玩起来。</p>
<h2 id="设置滤波器"><a href="#设置滤波器" class="headerlink" title="设置滤波器"></a>设置滤波器</h2><p>现在已经绘制出了频谱，那么我们对频谱来操作，最简单的理想低通滤波，就是截断一定区域的频谱，比如我们只需要距中心20的频谱，那么其余大于20的部分全部都为0，这样我们就完成了第一个滤波器。还记得那个很重要的关系么？我们将这个滤波器和频谱直接想乘，再看下频谱，是不是外围都变黑了，只留下中心部分了。</p>
<h2 id="变换回空域"><a href="#变换回空域" class="headerlink" title="变换回空域"></a>变换回空域</h2><p>在变回空域之前，需要先将中心再平移回原来的位置，这个交给ifftshift()。然后再用傅里叶反变换就可以把图片变回来。处理过的图像变得模糊不清，并且在大目标边缘有很多波纹的感觉，这就是传说中的振铃效应，细想一下还真的挺像的。</p>
<h2 id="以上，就是一个基本的傅里叶变换加滤波的流程"><a href="#以上，就是一个基本的傅里叶变换加滤波的流程" class="headerlink" title="以上，就是一个基本的傅里叶变换加滤波的流程"></a>以上，就是一个基本的傅里叶变换加滤波的流程</h2><h2 id="另外附上所有代码"><a href="#另外附上所有代码" class="headerlink" title="另外附上所有代码"></a>另外附上所有代码</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">clear</div><div class="line">clc</div><div class="line">close all;</div><div class="line">I = imread(<span class="string">'lena.jpeg'</span>);</div><div class="line">I = rgb2gray(I);</div><div class="line">figure;imshow(I);</div><div class="line"><span class="comment">% convert to double</span></div><div class="line">ID = im2double(I);</div><div class="line"><span class="comment">%  transform to frequency domain</span></div><div class="line"><span class="comment">%% --------转到频域，并将中心移至图像中心-------</span></div><div class="line">FID = fft2(ID);</div><div class="line">FS = fftshift(FID);</div><div class="line">showFrequency(FS);</div><div class="line"><span class="comment">%% --------理想低通滤波--------</span></div><div class="line"><span class="comment">% H = 1 if D(x,y) &lt; D0</span></div><div class="line"><span class="comment">% H = 0 if D(x,y) &gt; D0</span></div><div class="line">[m,n] = <span class="built_in">size</span>(FS);</div><div class="line">IdealFS = FS.* idealLowPass(m,n, <span class="number">20</span>);</div><div class="line">showFrequency(IdealFS);</div><div class="line"><span class="comment">%% --------巴特沃斯低通滤波器--------</span></div><div class="line"><span class="comment">% H = 1 / (1 + (D(x, y)/D0) ^ 2n)</span></div><div class="line"></div><div class="line">[m,n] = <span class="built_in">size</span>(FS);</div><div class="line">ButterworthFS = FS.* ButterworthLowPass(m, n, <span class="number">50</span>, <span class="number">1</span>);</div><div class="line">showFrequency(ButterworthFS);</div><div class="line"></div><div class="line"><span class="comment">%% --------高斯低通滤波器--------</span></div><div class="line">[m,n] = <span class="built_in">size</span>(FS);</div><div class="line">GaussianFS = FS.* GaussianLowPass(m, n, <span class="number">10</span>);</div><div class="line">showFrequency(GaussianFS);</div><div class="line"></div><div class="line"><span class="comment">%% --------将中心移回，转回空域，-------</span></div><div class="line">FS = ifftshift(GaussianFS);</div><div class="line"><span class="comment">%showFrequency(FS);</span></div><div class="line">IFID = ifft2(FS);</div><div class="line"><span class="comment">% convert back to uint8</span></div><div class="line">I8 = im2uint8(IFID);</div><div class="line">figure;imshow(I8);</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mat</span> = <span class="title">idealLowPass</span><span class="params">(M, N, D)</span></span></div><div class="line">    mat = <span class="built_in">zeros</span>(M,N);</div><div class="line">    <span class="keyword">for</span> r = <span class="number">1</span>:M</div><div class="line">        <span class="keyword">for</span> c = <span class="number">1</span>:N</div><div class="line">            <span class="keyword">if</span> (r- M/<span class="number">2</span>)^<span class="number">2</span>  + (c- N/<span class="number">2</span>)^<span class="number">2</span> &lt; D^<span class="number">2</span></div><div class="line">                mat(r,c)=<span class="number">1</span>;</div><div class="line">            <span class="keyword">end</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showFrequency</span><span class="params">(FS)</span></span></div><div class="line">RR = <span class="built_in">real</span>(FS);</div><div class="line">II = <span class="built_in">imag</span>(FS);</div><div class="line">A = <span class="built_in">sqrt</span>(RR.^<span class="number">2</span> + II.^<span class="number">2</span>);</div><div class="line">A = (A - min(A(:))) / (max(A(:) - min(A(:)))) * <span class="number">255</span>;</div><div class="line">figure; imshow(A);</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mat</span> = <span class="title">ButterworthLowPass</span><span class="params">(M,N,D_0,n)</span></span></div><div class="line">    mat = <span class="built_in">zeros</span>(M,N);</div><div class="line">    <span class="keyword">for</span> r = <span class="number">1</span>:M</div><div class="line">        <span class="keyword">for</span> c = <span class="number">1</span>:N</div><div class="line">            D = <span class="built_in">sqrt</span>((r- M/<span class="number">2</span>)^<span class="number">2</span>  + (c- N/<span class="number">2</span>)^<span class="number">2</span>);</div><div class="line">            mat(r,c) = <span class="number">1</span> / (<span class="number">1</span> + (D/D_0)^(<span class="number">2</span>*n));</div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mat</span> = <span class="title">GaussianLowPass</span><span class="params">(M, N, D_0)</span></span></div><div class="line">    mat = <span class="built_in">zeros</span>(M,N);</div><div class="line">    <span class="keyword">for</span> r = <span class="number">1</span>:M</div><div class="line">        <span class="keyword">for</span> c = <span class="number">1</span>:N</div><div class="line">            D = <span class="built_in">sqrt</span>((r- M/<span class="number">2</span>)^<span class="number">2</span>  + (c- N/<span class="number">2</span>)^<span class="number">2</span>);</div><div class="line">            mat(r,c) = <span class="built_in">exp</span>(-D^<span class="number">2</span> / (<span class="number">2</span>*D_0^<span class="number">2</span>));</div><div class="line">        <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></article></div></div></body></html>